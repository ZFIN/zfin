<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Cache-Control" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <title>
        GWT Modules</title>

    <link rel="stylesheet" type="text/css" href="/css/header.css">
    <link rel="stylesheet" type="text/css" href="/css/footer.css">
    <link rel=stylesheet type="text/css" href="/css/searchresults.css">
    <link rel=stylesheet type="text/css" href="/css/summary.css">
    <link rel=stylesheet type="text/css" href="/css/Lookup.css">
    <link rel=stylesheet type="text/css" href="/css/datapage.css">
    <link rel=stylesheet type="text/css" href="/css/popup.css">
    <link rel=stylesheet type="text/css" href="/css/tipsy.css">
    <link rel=stylesheet type="text/css" href="/css/jquery.modal.css">
    <link rel=stylesheet type="text/css" href="/css/typeahead.css">
    <link rel=stylesheet type="text/css" href="/css/bootstrap3/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/zfin.css">

    <script src="/javascript/fontawesome-all.min.js"></script>
    <script src="/javascript/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/javascript/jquery.modal.min.js"></script>
    <script type="text/javascript" src="/javascript/jquery.tipsy.js"></script>
    <script type="text/javascript" src="/javascript/sorttable.js"></script>
    <script type="text/javascript" src="/css/bootstrap3/js/tabs.js"></script>

    <script src="/javascript/autocompletify.js"></script>


</head>
<body>

<link rel=stylesheet type="text/css" href="/css/bootstrap3/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="/css/zfin-bootstrap-overrides.css"/>
<script type="text/javascript" src="/css/bootstrap3/js/bootstrap.js"></script>

<style type="text/css">
    .sub-data-manager {
        margin: 0px;
        margin-bottom: 0px;
        padding: 0px;
        padding-left: 10px;
        background-color: #9c9;
        padding-bottom: 2px;
        padding-top: 2px;
    }

    .nav-tabs {
        background-color: #699;
    }

    .nav-tabs > li > a {
        color: #000;
        font-weight: bold;
        border-radius: 5px;
    }

    .nav-tabs > li > a:hover {
        background-color: #33cc99 !important;
        border-radius: 5px;
        color: #000;
        border: 1px solid black;
    }

    .nav-tabs > li.active > a,
    .nav-tabs > li.active > a:focus,
    .nav-tabs > li.active > a:hover {
        background-color: #066 !important;
        color: #fff;
        border: 2px solid #3F515F;
    }

    .table-hover > tbody > tr > td:hover, .table-hover > tbody > tr > td:hover {
        background-color: #699 !important;
    }

    .table-bordered > tbody > tr > td {
        border-right-width: 0px;
        border-left-width: 0px;
        border-bottom-width: 0px;
    }
</style>

<script>
    //var pubID = "ZDB-PUB-970210-32";
    //var pubID = "ZDB-PUB-111111-1";
    var pubID = "ZDB-PUB-990507-16";
    //var pubID = "ZDB-PUB-160828-8";
</script>

<div ng-app="app">

    <table class="table table-bordered" width="100%" style="border-bottom-width: 0px">
        <tbody>
        <tr>
            <td>
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/marker/gene-add?type=GENE&source=\'"+pubID+"\'&fireCreateMarkerEvent=true","helpwindow","scrollbars=yes,height=850,width=550,resizable=yes")>
                    Add New Gene</a> |
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/marker/sequence-targeting-reagent-add?sequenceTargetingReagentPublicationZdbID="+pubID+"&sequenceTargetingReagentType=MRPHLNO","helpwindow","scrollbars=yes,height=900,width=1150,resizable=yes")>
                    Add New STR</a> |
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/antibody/add?antibodyPublicationZdbID="+pubID,"helpwindow","scrollbars=yes,height=850,width=550,resizable=yes")>
                    Add New Antibody</a> |
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/marker/gene-add?type=EFG&source='"+pubID+"'","helpwindow","scrollbars=yes,height=850,width=550,resizable=yes")>
                    Add New EFG</a> |
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/marker/region-add?regionPublicationZdbID="+pubID,"helpwindow","scrollbars=yes,height=850,width=550,resizable=yes")>
                    Add New Engineered Region</a> |
                <span quick-figure pub-id="ZDB-PUB-990507-16"></span> |
                <a class="small-new-link" href="javascript:"
                   onClick=open("/action/publication/"+pubID+"/feature-list","helpwindow","scrollbars=yes,height=850,width=700,resizable=yes")>FEATURE
                    TABLE</a>
            </td>
        </tr>
        <tr>
            <td>
                <div id="directAttributionName"></div>
            </td>
        </tr>
    </table>


    <ul class="nav nav-tabs" id="curation-tabs">
        <li class="active">
            <a href="#construct" aria-controls="construct" role="tab" class="nav-tabs-loading"
               data-toggle="tab">Construct</a>
        <li>
            <a href="#feature" aria-controls="feature" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="feature-tab">Feature</a>
        <li>
            <a href="#fish" aria-controls="fish" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="fish-tab">Fish</a>
        <li>
            <a href="#experiment" aria-controls="experiment" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="experiment-tab">Experiment</a>
        <li>
            <a href="#fx" aria-controls="fx" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="fx-tab">FX</a>
        <li>
            <a href="#pheno" aria-controls="pheno" role="tab" onclick="handleTabToggle('pheno')"
               class="nav-tabs-loading"
               data-toggle="tab" id="pheno-tab">Pheno</a>
        <li>
            <a href="#go" aria-controls="go" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="go-tab">GO</a>
        <li>
            <a href="#disease" aria-controls="disease" role="tab" class="nav-tabs-loading"
               data-toggle="tab" id="disease-tab">Disease</a>
        <li>
            <a href="#orthology" aria-controls="ortholog" role="tab" class="nav-tabs-loading"
               data-toggle="tab">Orthology</a>
        <li>
            <div role="tab" onclick="refresh()" style="cursor: pointer"><i class="fas fa-sync" aria-hidden="true"></i>
            </div>
    </ul>

    <div class="tab-content edit-form-content">
        <div role="tabpanel" class="tab-pane" id="construct">
            <table class="table table-borderless">
                <tr>
                    <td>
                        <span class="bold">CREATE NEW CONSTRUCT: </span>
                        <a onclick="showCreateConstructSection()" id="showConstructAdd"
                           style="text-decoration:underline">Show</a>
                        <a style="display: none;" onclick="hideCreateConstructSection()" id="hideConstructAdd">Hide</a>

                        <div id="constructadd" style="display: none;"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span class="bold">EDIT CONSTRUCT: </span>
                        <a onclick="showEditConstructSection()" id="showConstructEdit"
                           style="text-decoration:underline">Show</a>
                        <a style="display: none;" onclick="hideEditConstructSection()" id="hideConstructEdit">Hide</a>

                        <div id="constructedit" style="display: none;"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="construct-relationship-link"></div>
                        <div id="construct-relationship"></div>
                    </td>
                </tr>
            </table>

            <script type="text/javascript">
                jQuery('#constructadd').load('/action/construct/construct-add?constructPublicationZdbID=' + pubID + '.zdbID}');
                jQuery('#constructedit').load('/action/construct/construct-update?constructPublicationZdbID=' + pubID);
                function showCreateConstructSection() {
                    storeSession('$ZDB_ident', pubID, 'featcur_featcreation', 'show', '/action/curation/' + pubID);
                    jQuery('#constructadd').show();
                    jQuery('#showConstructAdd').hide();
                    jQuery('#hideConstructAdd').show();
                }
                function hideCreateConstructSection() {
                    storeSession('$ZDB_ident', pubID, 'featcur_featcreation', 'hide', '/action/curation/' + pubID);
                    jQuery('#constructadd').hide();
                    jQuery('#showConstructAdd').show();
                    jQuery('#hideConstructAdd').hide();
                }
                function showEditConstructSection() {
                    storeSession('$ZDB_ident', pubID, 'featcur_featediting', 'show', '/action/curation/' + pubID);
                    jQuery('#constructedit').show();
                    jQuery('#showConstructEdit').hide();
                    jQuery('#hideConstructEdit').show();
                }
                function hideEditConstructSection() {
                    storeSession('$ZDB_ident', pubID, 'featcur_featediting', 'hide', '/action/curation/' + pubID);
                    jQuery('#constructedit').hide();
                    jQuery('#showConstructEdit').show();
                    jQuery('#hideConstructEdit').hide();
                }
            </script>
        </div>
        <div role="tabpanel" class="tab-pane active" id="feature">
            <div id="feature-module"></div>
        </div>
        <div role="tabpanel" class="tab-pane" id="fish">
            <div id="fishTab"></div>
        </div>
        <div role="tabpanel" class="tab-pane" id="experiment">
            <div id="experimentTab"></div>
        </div>
        <div role="tabpanel" class="tab-pane" id="fx">
            <table class="table table-borderless">
                <tr>
                    <td>
                        <div id="expressionZone"></div>
                    </td>
                </tr>
            </table>
        </div>
        <div role="tabpanel" class="tab-pane" id="pheno">
            <table class="table table-borderless">
                <tr>
                    <td>
                        <span id="show-hide-experiments"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="display-experiment"></div>
                        <div id="image-loading"></div>
                        <div id="display-experiment-errors"></div>

                        <p></p>
                        <table width="100%" class="curation-filter" border="0" cellpadding="0">
                            <tbody>
                            <tr>
                                <td style="font-weight:bold;"> Show:</td>
                                <td>
                                    Only Fig:
                                    <span id="curation-filter-figure"></span>
                                </td>
                                <td>
                                    Only Fish:
                                    <span id="curation-filter-fish"></span>
                                </td>
                                <td>
                                    Only Feature:
                                    <span id="curation-filter-feature"></span>
                                </td>
                                <td>
                                    <span id="curation-filter-reset"></span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p></p>

                        <div id="show-hide-expressions"></div>

                        <table width="100%">
                            <tr>
                                <td colspan="2">
                                    <div id="check-size-bar"></div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div id="display-expressions"></div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div id="display-mutants-construction-zone"></div>
                                </td>
                            </tr>
                        </table>
                        <br>

                        <div id="show-hide-eap"></div>
                        <table width="100%">
                            <tr>
                                <td colspan="2">
                                    <div id="display-eap"></div>
                                </td>
                            </tr>
                        </table>
                        <div id="image-loading-expression-section"></div>
                        <div id="display-expression-errors"></div>

                        <p></p>

                        <div id="show-hide-structures"></div>
                        <div id="update-experiments"></div>
                        <table width="100%">
                            <tr>
                                <td class="right-align-box">
                                    <div id="structures-check-size-bar"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div id="display-structures"></div>
                                </td>
                            </tr>
                        </table>
                        <div id="update-experiments-bottom"></div>
                        <div id="image-loading-structure-section"></div>
                        <div id="display-structure-errors"></div>
                        <div id="construction-zone"></div>

                        <a name="structure-construction-zone"></a>

                        <div id="structure-pile-construction-zone" style="display:inline;">
                            <table class="term-construction-zone">
                                <tbody>
                                <tr>
                                    <td valign="top">
                                        <table>
                                            <tr>
                                                <td align="left" width="100" class="bold">Superterm
                                                </td>
                                                <td class="bold">:</td>
                                                <td align="right" width="150" class="bold">Subterm
                                                </td>
                                            </tr>
                                        </table>

                                        <table border="0" cellpadding="5" cellspacing="3">
                                            <tr>
                                                <td align="center" bgcolor="#006666" width="1">
                                                </td>
                                                <td align="top">
                                                    <div id="structure-pile-construction-zone-entity_subterm-info"></div>
                                                    <p>
                                                    </p>
                                                    <span class="indent2"><b><i>within the</i></b></span>
                                                    <span id="structure-pile-construction-zone-swap-terms"
                                                          class="indent3"></span>
                                                </td>
                                            </tr>
                                        </table>

                                        <table>
                                            <tr>
                                                <td>
                                                    <div id="structure-pile-construction-zone-entity_superterm-info"></div>
                                                </td>
                                            </tr>
                                        </table>
                                        <div class="dots"></div>
                                        <table>
                                            <tr>
                                                <td colspan="2">
                                                    <div id="structure-pile-construction-zone-quality-info"></div>
                                                </td>
                                            </tr>
                                        </table>
                                        <div id="related-terms-panel">
                                            <div class="dots"></div>
                                            <table>
                                                <tr>
                                                    <td align="left" width="100" class="bold">Superterm
                                                    </td>
                                                    <td class="bold">:</td>
                                                    <td align="right" width="150" class="bold">Subterm
                                                    </td>
                                                </tr>
                                            </table>

                                            <table border="0" cellpadding="5" cellspacing="3">
                                                <tr>
                                                    <td align="center" bgcolor="#006666" width="1">
                                                    </td>
                                                    <td align="top">
                                                        <div id="structure-pile-construction-zone-related_entity_subterm-info"></div>
                                                        <p>
                                                        </p>
                                                        <span class="indent2"><b><i>within the</i></b></span>
                                                        <span id="structure-pile-construction-zone-swap-related-terms"
                                                              class="indent3"></span>
                                                    </td>
                                                </tr>
                                            </table>

                                            <table>
                                                <tr>
                                                    <td>
                                                        <div id="structure-pile-construction-zone-related_entity_superterm-info"></div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <table>
                                            <tr>
                                                <td>
                                                    <div id="tag"></div>
                                                </td>
                                                <td>
                                                    <div id="structure-pile-construction-zone-tag-info"></div>
                                                </td>
                                                <td>
                                                    <div id="structure-pile-construction-zone-submit-reset"></div>
                                                </td>
                                            </tr>
                                        </table>

                                        <p>

                                        <div id="structure-pile-construction-zone-errors"></div>
                                        <br>
                                    </td>
                                    <td></td>
                                    <td>
                                        <iframe src="javascript:''" id='__gwt_historyFrame'
                                                style='position:absolute;width:0;height:0;border:0'></iframe>
                                        <table style="width:550px; overflow: auto; border: 0.1px; border-style:solid">
                                            <tr>
                                                <td>
                                                    <div id="structure-pile-construction-zone-terminfo"></div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>

            <style>
                .indent2 {
                    margin-left: 100px;
                }

                .indent3 {
                    margin-left: 70px;
                }
            </style>
        </div>
        <div role="tabpanel" class="tab-pane" id="go">
            <script src="/javascript/popups.js"></script>
            <table class="table table-borderless">
                <tr>
                    <td>
                        <div id="go-add-link"></div>
                        <div id="go-evidence-add"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="go-evidence-display-filter"></div>
                        <div id="go-evidence-display"></div>
                    </td>
                </tr>
            </table>
            <!--
            Add ontology name as a hidden field
            -->
            <div class="GO_TERM_single" aria-hidden="true" style="display: none;">
                cellular_component,molecular_function,biological_process
            </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="disease">
            <div id="humanDiseaseZone"></div>
        </div>
        <div role="tabpanel" class="tab-pane" id="orthology">
            <script src="/javascript/angular/angular.min.js"></script>
            <script src="/javascript/angular/paging.min.js"></script>
            <script src="/javascript/zfin-app.module.js"></script>

            <script src="/javascript/figure.service.js"></script>
            <script src="/javascript/quick-figure.directive.js"></script>
            <script src="/javascript/trusted-html.filter.js"></script>
            <script src="/javascript/inline-edit-textarea.directive.js"></script>
            <script>
                // we want the jquery modal, not the bootstrap one on this page
                $.fn.modal.noConflict();
            </script>

            <table class="table table-borderless">
                <tr>
                    <td>
                        <div ortho-edit pub="ZDB-PUB-990507-16"></div>
                    </td>
                </tr>
            </table>
        </div>

        <script>
            function refresh() {
                var tabName = $(".tab-pane.active").attr("id");
//            alert("Tab name: "+ tabName)
                refreshTab(tabName);
            }

            function refreshOrthologyGeneList() {
                angular.element(document.getElementById("evidence-modal")).scope().vm.fetchGenes()
            }

            function displayLoadingStatus(tabName, isLoading) {
                /*
                 if (tabName = "pheno")
                 alert(tabName + ": " + isLoading);
                 */
                $('#' + tabName + '-tab').toggleClass("nav-tabs-loading", isLoading);
            }

            $(function () {

                function goToTab(hash) {
                    $('#curation-tabs a[href=' + hash + ']').tab('show');
                    //alert("Hash:"+hash)
                }

                var hash = window.location.hash;
                if (hash) {
                    goToTab(hash);
                }

                $('#curation-tabs a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                    var href = $(e.target).attr('href');
                    if (history.pushState) {
                        history.pushState(null, null, href);
                    } else {
                        location.hash = href;
                    }
                });

                $('.edit-form-content').on('click', "a[href^='#']", function () {
                    var hash = $(this).attr('href');
                    goToTab(hash);
                });
            });

            jQuery(document).ready(function () {
                jQuery(".new-pub").on("click", function () {
                    var pubID = jQuery("#pubID").val();
                    jQuery('#newPublication').attr('action', "/action/curation/${module}/" + pubID);
                    jQuery("#newPublication").submit();
                    e.preventDefault();
                });
            });
        </script>

        <script type="text/javascript" language="javascript"
                src="/org.zfin.gwt.curation.Curation/org.zfin.gwt.curation.Curation.nocache.js"></script>

        <script type="text/javascript">
            var curationProperties = {
                zdbID: pubID,
                moduleType: "feature",
                debug: "false"
            }
        </script>

        <script type="text/javascript">
            // this attaches onMouseOver handlers to each of the items in the
            // auto suggest box (popup panel). changes in the selected item should
            // trigger an update of the term info box.
            // ony body
            var showTermInfo = function () {
                var selectedTerm = $(".item-selected").text();
                var tabName = window.location.hash.substr(1);
                if (selectedTerm.length > 0) {
                    var div = $(".termInfoUsed").attr("class");
                    if ($(".termInfoUsed").length > 0) {
                        var classArray = div.split(" ");
                        var entityName = classArray[2];
                        var selector = "select." + entityName + "_" + tabName;
                        var selectionBox = $(selector);
                        var selectedOption;
                        if (!selectionBox.length) {
                            var element = "." + entityName + "_single_" + tabName;
                            selectedOption = $(element).text();
                        } else {
                            selectedOption = selectionBox.val();
                        }
                        updateTermInfoBox(selectedTerm, selectedOption, tabName);
                    }
                }
            };

            jQuery("body").on("mouseover", ".item-selected", showTermInfo)
                .on("keydown", "input", showTermInfo);

        </script>


    </div>
</div>
</body>

</html>