<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<!-- Alwyas include the full package in each class.name attribute. This allows refactoring to identify
     the class and include them. Otherwise a refactoring of a class reference here is not recognized and
     could potentially break the code (e.g. moving a class into a different package. -->
<hibernate-mapping package="org.zfin.orthology">

    <typedef class="org.zfin.framework.StringEnumValueUserType" name="evidenceCode">
        <param name="enumClassname">org.zfin.orthology.OrthoEvidence$Code</param>
    </typedef>

    <typedef class="org.zfin.framework.StringEnumValueUserType" name="organism">
        <param name="enumClassname">org.zfin.orthology.Species</param>
    </typedef>

    <class name="org.zfin.orthology.Orthologue" table="orthologue">
        <id name="zdbID" type="string">
            <column name="zdb_id" not-null="true"/>
            <generator class="org.zfin.database.ZdbIdGenerator">
                <param name="type">ORTHO</param>
                <param name="insertActiveData">true</param>
            </generator>
        </id>
        <property name="name" column="ortho_name"/>
        <property name="abbreviation" column="ortho_abbrev"/>
        <property name="organism" column="organism" type="organism"/>
        <property name="chromosome" column="ortho_chromosome" type="string"/>
        <property name="position" column="ortho_position" type="string"/>
        <many-to-one name="gene" column="c_gene_id" class="org.zfin.marker.Marker" not-null="true"/>

        <!--<property name="evidenceCode" column="oev_evidence_code" type="string"/>-->

        <!-- this is an exotic beast, according to the book.
             it maps a collection of orthoEvidence objects,
            OrthoEvidence has a similarly complex mapping-->
        <!--<set name="evidences" table="orthologue_evidence_code">-->
            <!--<key column="oev_ortho_zdb_id"/>-->
            <!--<one-to-many class="EvidenceCode"/>-->
        <!--</set>-->
        <!--<set name="evidence" table="orthologue_evidence">-->
            <!--<key column="oev_ortho_zdb_id"/>-->
            <!--<composite-element class="org.zfin.orthology.OrthoEvidence">-->
                <!--<parent name="orthologue"/>-->

                <!--<many-to-one name="orthologueEvidenceCode" column="oev_evidence_code"-->
                    <!--not-null="true" class="org.zfin.orthology.EvidenceCode"/>-->
                <!--<many-to-one name="orthologuePublication" column="oev_pub_zdb_id"-->
                    <!--not-null="true" class="org.zfin.publication.Publication"/>-->
            <!--</composite-element>-->
        <!--</set>&ndash;&gt;-->

    </class>

    <class name="org.zfin.orthology.OrthoEvidenceDisplay" table="orthologue_evidence_display">
        <id name="zdbID" type="string">
            <column name="oevdisp_zdb_id" not-null="true"/>
            <generator class="org.zfin.database.ZdbIdGenerator">
                <param name="type">OEVDISP</param>
                <param name="insertActiveData">true</param>
            </generator>
        </id>
        <many-to-one name="gene" column="oevdisp_gene_zdb_id" class="org.zfin.marker.Marker" not-null="true"/>
    </class>


    <class name="org.zfin.orthology.repository.OrthologyHelper" table="orthology_view">
        <id name="zdbID" type="string">
            <column name="vorthy_orthologue_zdb_id" not-null="true"/>
            <generator class="org.zfin.database.ZdbIdGenerator">
                <param name="type">ORTHO</param>
            </generator>
        </id>

        <property name="geneID">
            <column name="vorthy_gene_zdb_id"/>
        </property>

        <property name="species">
            <column name="vorthy_species"/>
        </property>

        <property name="symbol">
            <column name="vorthy_gene_abbrev"/>
        </property>

        <property name="chromosome">
            <column name="vorthy_chromosome"/>
        </property>

        <property name="position">
            <column name="vorthy_position"/>
        </property>

        <set name="evidence" lazy="true" table="orthologue_evidence">
            <key column="oev_ortho_zdb_id"/>
            <many-to-many class="org.zfin.orthology.EvidenceCode" column="oev_evidence_code"/>
        </set>


    </class>

    <class name="org.zfin.orthology.repository.ZebrafishOrthologyHelper" table="orthology_view">
        <id name="zdbID" type="string">
            <column name="vorthy_orthologue_zdb_id" not-null="true"/>
            <generator class="org.zfin.database.ZdbIdGenerator">
                <param name="type">ORTHO</param>
            </generator>
        </id>

        <property name="geneID">
            <column name="vorthy_gene_zdb_id"/>
        </property>

        <property name="species">
            <column name="vorthy_species"/>
        </property>

        <property name="symbol">
            <column name="vorthy_gene_abbrev"/>
        </property>

        <property name="chromosome">
            <column name="vorthy_chromosome"/>
        </property>

        <property name="position">
            <column name="vorthy_position"/>
        </property>

        <set name="evidence" lazy="true" table="orthologue_evidence">
            <key column="oev_ortho_zdb_id"/>
            <many-to-many class="org.zfin.orthology.EvidenceCode" column="oev_evidence_code"/>
        </set>

        <set name="orthologies" lazy="false">
            <key column="vorthy_gene_zdb_id"/>
            <one-to-many class="org.zfin.orthology.repository.OrthologyHelper"/>
        </set>

    </class>

    <class name="org.zfin.orthology.OrthoEvidence" table="orthologue_evidence">
        <composite-id>
            <key-property name="orthologueZdbID" column="oev_ortho_zdb_id" type="string"/>
            <key-many-to-one name="publication" column="oev_pub_zdb_id" class="org.zfin.publication.Publication" />
            <key-property name="orthologueEvidenceCode" column="oev_evidence_code" type="evidenceCode"/>
        </composite-id>
    </class>

    <class name="org.zfin.orthology.OrthologyEvidenceFastSearch" table="orthologue_evidence_display" >
        <id name="zdbID" type="string">
            <column name="oevdisp_zdb_id" not-null="true"/>
            <generator class="org.zfin.database.ZdbIdGenerator">
                <param name="type">OEVDISP</param>
                <param name="insertActiveData">true</param>
            </generator>
        </id>
        <property name="code" column="oevdisp_evidence_code" type="evidenceCode"/>
        <property name="organism" column="oevdisp_organism_list" />
        <many-to-one name="marker" column="oevdisp_gene_zdb_id" class="org.zfin.marker.Marker"/>
    </class>

    <class name="org.zfin.orthology.EvidenceCode" table="orthologue_evidence_code">

        <id name='code' type="string">
            <column name="oevcode_code" not-null="true"/>
            <generator class="native"/>
        </id>
        <property name="order" column="oevcode_order" type="java.lang.Integer" not-null="true"/>

    </class>

    <class name="org.zfin.orthology.repository.AccessionHelperDBLink" table="db_link">

        <id name="zdbID" type="string">
            <column name="dblink_zdb_id" not-null="true"/>
            <generator class="native"/>
        </id>

        <property name="orthoID">
            <column name="dblink_linked_recid"/>
        </property>

        <property name="accessionNum">
            <column name="dblink_acc_num_display"/>
        </property>

        <property name="accessionHyperLinkNum">
            <column name="dblink_acc_num"/>
        </property>

        <!--<one-to-one name="fdbContHelper" class="org.zfin.orthology.repository.AccessionHelperFDBCont" foreign-key="dblink_fdbcont_zdb_id" />-->

        <many-to-one name="fdbContHelper" column="dblink_fdbcont_zdb_id" unique="true" not-null="true"/>

    </class>

    <class name="org.zfin.orthology.repository.AccessionHelperFDBCont" table="foreign_db_contains">

        <id name="fdbcontID" type="string">
            <column name="fdbcont_zdb_id" not-null="true"/>
            <generator class="native"/>
        </id>

        <property name="species">
            <column name="fdbcont_organism_common_name"/>
        </property>

        <!--<one-to-one name="FDBhelper" class="org.zfin.orthology.repository.AccessionHelperFDB" foreign-key="fdbcont_fdb_db_id" />-->

        <many-to-one name="FDBhelper" column="fdbcont_fdb_db_id" unique="true" not-null="true"/>
    </class>

    <class name="org.zfin.orthology.repository.AccessionHelperFDB" table="foreign_db">

        <id name="FDBname" type="string">
            <column name="fdb_db_name" not-null="true"/>
            <generator class="native"/>
        </id>

        <property name="significance">
            <column name="fdb_db_significance"/>
        </property>

        <property name="hyperLinkQuery">
            <column name="fdb_db_query"/>
        </property>

    </class>


</hibernate-mapping>
