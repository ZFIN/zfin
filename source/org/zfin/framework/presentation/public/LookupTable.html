<html>
<head>
    <title>Lookup Application</title>
    <link rel="stylesheet" type="text/css" href="/gwt/org.zfin.framework.presentation.Lookup/Lookup.css"/>
    <link rel="stylesheet" type="text/css" href="/org.zfin.framework.presentation.Lookup/Lookup.css"/>
    <!--                                           -->
    <!-- The module reference below is the link    -->
    <!-- between html and your Web Toolkit module  -->
    <!--                                           -->
    <meta name='gwt:module' content='org.zfin.framework.presentation.LookupTable'>
</head>
<body>

line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>
line <br>

<!--                                            -->
<!-- This script is required bootstrap stuff.   -->
<!-- You can put it in the HEAD, but startup    -->
<!-- is slightly faster if you include it here. -->
<!--                                            -->

<script type="text/javascript">
    var LookupProperties = {
        divName: "anatomyTerm",
        inputName: "searchTerm",
        showError: true,
         buttonText: "Add Term",
        imageURL: "/org.zfin.framework.presentation.LookupTable/",
        hiddenName: "otherHiddenName",
        type: "ANATOMY_ONTOLOGY",
        wildcard: false,
        width: 40,
        previousTableValues: "radial glial cell,dorsal tooth,pelvic adductor profundus"
    };
</script>

<script type="text/javascript">

    var intervalId = 0 ;
    var status ;
    function call_submit() {
        var pauseIcrement = 500 ;  // wait up to 4 seconds
        var currentTime = new Date() ;  // wait up to 4 seconds
        validateLookup() ;
        currentTime = new Date() ;  // wait up to 4 seconds
        intervalId = setInterval('doValidate('+currentTime.getMilliseconds()+');',pauseIcrement) ;
    }

    function doValidate(currentTime ){
        var maxTime = 5000 ;
        var diff  = (new Date()).getMilliseconds() - currentTime;
        var inputElement = document.getElementById(LookupProperties.inputName);
        status = getValidationStatus() ;
        // recheck
        if(status == "TERM_STATUS_LOOKING" || status=="TERM_STATUS_FAILURE"  && diff < maxTime){
            validateLookup() ;
            return ;
        }

        // go ahead and do the submit
        if(status == "TERM_STATUS_FOUND_EXACT"){
            alert("should be submitting") ;
        }
        else
        // bad form, so cancel submit
        if(status == 'TERM_STATUS_FOUND_MANY'){
            alert("cancelling submit, found too many")
        }
        else
        if(status == "TERM_STATUS_FOUND_NONE"){
            alert("cancelling submit, found none")
        }
        clearInterval(intervalId) ;
    }



    function submit_form(){
        validateLookup() ;
        var status = getValidationStatus() ;
        alert("est: "+document.testform.otherHiddenName.value) ;
        alert("status: "+status) ;
    }
</script>

<!--<script language="javascript" src="gwt.js"></script>-->
<script type="text/javascript" language="javascript" src="org.zfin.framework.presentation.LookupTable.nocache.js"></script>

<!-- OPTIONAL: include this if you want history support -->
<iframe id="__gwt_historyFrame" style="width:0;height:0;border:0"></iframe>

<form name="testform" action="webdriver" method="get" onsubmit="return false ;">
    <table>
        <tr> <td> Above term </td> </tr>
        <tr> <td> <div id="anatomyTerm"> </div> </td> </tr>
        <tr>
            <td>  <input type="hidden" id="otherHiddenName" name="otherHiddenName" value="oldValue"> </td>
            <td> <input type="button" value="search" onclick="call_submit() ;"> </td>
        </tr>
        <tr> <td> Below term </td> </tr>
    </table>
</form>

<script type="text/javascript">
    function reset_table(){
        this.clearTable() ;
    }
</script>

<input type="button" value="remove tables" onclick="reset_table()">

</body>

</html>
