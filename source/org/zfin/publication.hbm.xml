<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="org.zfin.publication">

    <class name="org.zfin.publication.Publication" table="publication">
        <id name="zdbID" type="string">
            <column name="zdb_id" not-null="true"/>
            <generator class="native"/>
        </id>

        <property name="title" lazy="false">
            <column name="title" not-null="true"/>
        </property>

        <property name="authors">
            <column name="authors" not-null="true"/>
        </property>

        <property name="shortAuthorList">
            <column name="pub_mini_ref" not-null="true"/>
        </property>

<!-- Do not use this! When retrieving this table in a query with lots of
     out joins the abstract has so many characters that you will get an  Informix error:
     maximum output rowsize (32767) exceeded
        <property name="abstractText" lazy="true" >
            <column name="pub_abstract" not-null="false"/>
        </property>
-->

        <property name="publicationDate" column="pub_date"/>
        <property name="closeDate" column="pub_completion_date"/>
        <property name="volume" column="pub_volume" lazy="true"/>
        <property name="pages" column="pub_pages" lazy="true"/>
        <property name="type" column="jtype"/>
        <property name="accessionNumber" column="accession_no" lazy="true"/>
        <property name="fileName" column="pub_file" lazy="true"/>
        <property name="doi" column="pub_doi" lazy="true"/>
        <property name="indexed" column="pub_is_indexed"/>
        <property name="indexedDate" column="pub_indexed_date"/>

        <many-to-one name="journal" class="org.zfin.publication.Journal" column="pub_jrnl_zdb_id" insert="false"
                     update="false"/>

        <set name="expressionExperiments" lazy="true">
            <key column="xpatex_source_zdb_id"/>
            <one-to-many class="org.zfin.expression.ExpressionExperiment"/>
        </set>

        <set name="figures" lazy="true">
            <key column="fig_source_zdb_id" update="false"/>
            <one-to-many class="org.zfin.expression.Figure" />
        </set>
    </class>

    <class name="org.zfin.publication.DOIAttempt" table="doi_attempts">
        <id name="id" type="long">
            <column name="doia_pk_id" not-null="true"/>
            <generator class="increment"/>
        </id>
        <property name="numAttempts" column="doia_num_attempts" not-null="true"/>
        <many-to-one name="publication" column="doia_pub_zdb_id" not-null="true"/>
    </class>

    <class name="org.zfin.publication.Journal" table="journal">
        <id name="zdbID" type="string">
            <column name="jrnl_zdb_id" not-null="true"/>
            <generator class="native"/>
        </id>

        <property name="name">
            <column name="jrnl_name" not-null="true"/>
        </property>

        <property name="abbreviation">
            <column name="jrnl_abbrev" not-null="true"/>
        </property>

        <property name="publisher">
            <column name="jrnl_publisher" not-null="true"/>
        </property>
    </class>

</hibernate-mapping>
