<HTML>
<head>
<META HTTP-EQUIV="EXPIRES" CONTENT="Wed Sep 11 09:35:25 PDT 1996">
<TITLE>Add a new ZFIN LAB record</TITLE>
</head>


<?MISQL SQL="
  select WebExplode(object, 'page_title=New Lab&permission=root') 
    from webPages 
    where ID = 'aa-secure_navigation.apg';">
  $1
<?/MISQL>

<?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-htmlpageheader.apg';">$1<?/MISQL>

<?MIBLOCK COND="$(NC,$AUTHORIZED,false)">

  <!-- THIS IS A VERY TRICKY PAGE. The main challenge lies in the fact 
       that users will be "building up" a submission, adding pubs to it, 
       selecting affected gene, etc etc.  In other words, they may engage 
       in lots of "side processes" before they have built up their final 
       submission and press the "submit" button.
  -->


  <!-- Pass in any variables you want the form to be initialized with on 
       the command-line. You will need to modify setup-new-lab to avoid 
       blasting these values however.
  -->

  <!-- FIRST DO SOME IMPORTANT SETUP. MOSTLY THIS IS IN SEPERATE FILE TO 
       KEEP FILE SIZE MANAGEABLE
  -->
  <?MISQL SQL="
    select WebExplode(object,'') 
      from webPages 
      where ID = 'aa-setup-new-lab.apg';">
    $1
  <?/MISQL>

  <FORM METHOD=POST ACTION="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->">
    <?MIVAR>
      <INPUT type=hidden NAME=temp_oid VALUE=$temp_oid>
      <INPUT type=hidden NAME=MIval VALUE="aa-process-lab.apg">
    <?/MIVAR>

    <h1 align=center> Add a new LAB to ZFIN</h1>



    <p>
    The following information is <B>REQUIRED</B> to create the new LAB record. 
    Please enter the requested information in the boxes below, and then  
    click on the "SUBMIT" button.


    <p>
    <b>Full Name:</b><br>
    This field should hold the official name of the lab. 
    For example, "Westerfield Lab". 
    <INPUT TYPE=text 
           <?MIVAR COND=$(ISNOVALUE,$name)>value="$name" <?/MIVAR>
           NAME="name" size=80> 
    <p>

    <b>Address:</b><br>
    This field holds the LAB's surface mail address. Be sure to include 
    all necessary zip codes or country codes. For example:<br>
    
<pre>Institute of Neuroscience
1254 University of Oregon
Eugene,OR 97403-1254
USA
</pre>
    <TEXTAREA name=address 
              WRAP=virtual 
              rows=6 
	      cols=70><?MIVAR COND=$(ISNOVALUE,$address)>$address<?/MIVAR></TEXTAREA>
    <p>

    <b>Front Office Phone:</b><br>
    This field should hold the front office (general contact) phone number 
    for the lab. Be sure to include relevant country codes.
    <INPUT type=text 
           <?MIVAR COND=$(ISNOVALUE,$phone)>value="$phone"<?/MIVAR>
	   name="phone" size="50">
    <p>
 
    <b>Front Office Fax:</b><br>
    This field should hold the front office (general contact) fax number 
    for the lab. Be sure to include relevant country codes.
    <INPUT type=text 
           <?MIVAR COND=$(ISNOVALUE,$fax)>value="$fax" <?/MIVAR> 
           name="fax" size="50">
    <p>


    <b>email:</b><br>
    This field should hold  the general contact email address for the lab. 
    <INPUT type=text 
	   <?MIVAR COND=$(ISNOVALUE,$email)>value="$email" <?/MIVAR>
	   name="email" size="80">
    <p>

    <b>URL:</b><br>
    This field should hold the address (URL) for the lab's WWW site.
    <INPUT type=text 
	   <?MIVAR COND=$(ISNOVALUE,$url)>value="$url" <?/MIVAR>
           name="url" size="80">
    <p>

    <b>Allele Designation:</b><br>

    <?MICOMMENT>
    <INPUT type=text 
	   <?MIVAR COND=$(ISNOVALUE,$allele_prefix)>value="$allele_prefix" <?/MIVAR>
           name="allele_prefix" size="20">
           <?/MICOMMENT>
	  <SELECT name=allele_prefix>
            <option value="" ></option>
            <?MISQL SQL="
            select fp.fp_prefix,fp.fp_pk_id 
from feature_prefix fp 
order by fp.fp_prefix asc">
                  <option value="$2" >$1</option>
            <?/MISQL>
	  </SELECT> 
    <p>


    <A NAME="pub-info">
    <HR width=100% size=3>
    <p>
    <TABLE width=100%>
      <TR> 
	<TD><b>OFFICIAL CONTACT</b>:
	  <?MIVAR COND=$(EC,$contact_person,NULL)>Unspecified<?/MIVAR>
	  <?MISQL COND=$(NC,$contact_person,NULL) SQL="
	    select full_name 
	      from person 
	      where zdb_id = '$contact_person';">
	    <UL><b>$1</b></UL>
	  <?/MISQL>
	</TD>
	<TD>
	  <input type=submit name="s_contact" value="Specify Contact Person">
	</TD>
      </TR>

      <TR>
	<TD colspan=2> 
	  <HR width=50%>
	</TD>
      </TR>
    </TABLE>

    <TABLE width=100%>
      <TR>
	<TD><b>LAB MEMBERS:</b> </TD>
	<TD><input type=submit name="s_member" value="Add"> a new 
	  <SELECT name=mem_status>
            <?MISQL SQL="select distinct labpos_position,labpos_order from lab_position order by labpos_order">          <option value="$1" >$1
            <?/MISQL>
	  </SELECT> to the lab. 
	</TD>
      </TR>
      <TR>
	<TD colspan=2>
	  <ul>
	    <?MISQL SQL="
	      select b.full_name, a.position, c.labpos_order 
		from int_person_lab a, person b, lab_position c
		where target_id = '$temp_oid' 
		  and source_id = b.zdb_id 
                  and a.position = c.labpos_position
		order by c.labpos_order, b.full_name;">
	      <b>$1</b>,<font size=-1> $2 </font> <br>
	    <?/MISQL>
	  </ul>
	</TD>
      </TR>
    </TABLE>

    <HR width=80%>
    <p>
    <input type=submit name="s_done" value="SUBMIT">
    <input type=hidden name=MIval value=aa-process-lab.apg>

  </FORM>


<?/MIBLOCK>  <!-- ends cond authorize -->


<?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-htmlpagefooter.apg';">$1<?/MISQL>
