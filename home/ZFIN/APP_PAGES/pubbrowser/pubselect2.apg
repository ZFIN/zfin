
<html>
  <head>


<?MIVAR Name=page_name>ZFIN Publication $(IF,$(XST,$query_results),List,Select)<?/MIVAR>

<?MIVAR><TITLE>$page_name</TITLE><?/MIVAR>

<?MIVAR NAME=$userid>GUEST<?/MIVAR>

<?MIVAR COND="$(NXST,$authtype)" NAME=$authtype>anyauth<?/MIVAR>
<?MIVAR COND="$(NXST,$jtype)" NAME=$jtype>any<?/MIVAR>
<?MIVAR COND="$(NXST,$century)" NAME=$century>20<?/MIVAR>
<?MIVAR COND="$(NXST,$anon1)" NAME=$anon1>abstract<?/MIVAR>
<?MIVAR COND="$(NXST,$order_pref)" NAME=$order_pref>date<?/MIVAR>
<?MIVAR COND="$(NXST,$cur_status)" NAME=$cur_status>any<?/MIVAR>
<?MIVAR COND="$(NXST,$pub_status)" NAME=$pub_status>any<?/MIVAR>
<?MIVAR COND="$(NXST,$yr_cmpr)" NAME=$yr_cmpr>=<?/MIVAR>
<?MIVAR COND="$(NXST,$START)" NAME=$START>1<?/MIVAR>

  </head>

<?MIBLOCK COND="$(NXST,$accession)">
  <?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-htmlpageheader.apg';">$1<?/MISQL>
<?/MIBLOCK>

<SCRIPT>

function form_submit() {
document.critform.submit();
}

function call_reset() {

document.critform.authors.value = "";
document.critform.title.value = "";
document.critform.year.value = "";
document.critform.anon1text.value = "";
document.critform.jtype.selectedIndex = 0;
document.critform.pub_status.selectedIndex = 0;
document.critform.cur_status.selectedIndex = 0;
document.critform.yr_cmpr.selectedIndex = 0;
document.critform.century.selectedIndex = 1;
document.critform.anon1.selectedIndex = 0;
document.critform.order_pref.selectedIndex = 0;
document.critform.authtype.selectedIndex = 0;
document.critform.WINSIZE.value = 10;
document.critform.START.value = "";


}

</SCRIPT>

<?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-identify.apg';">$1<?/MISQL>







<?MIBLOCK COND="$(XST,$query_results)">


<!-- THIS NEXT PART IS EXECUTED AFTER THE PERSON ENTERS SOME CRITERIA -->
<?MIVAR NAME=$constraint COND="$(NXST,$constraint)"> <?/MIVAR>


<?MIBLOCK COND="$(OR,
		$(XST,$authors),
		$(XST,$title),
		$(XST,$year),
		$(XST,$anon1text),
		$(AND,$(XST,$jtype),$(NC,$jtype,any)),
		$(AND,$(XST,$pub_status),$(NC,$pub_status,any)),
		$(AND,$(XST,$cur_status),$(NC,$cur_status,any)))">

	<!-- First filter authors for apostrophes! -->
	<?MIVAR COND="$(XST,$authors)" NAME=$authors DELIMIT="'" REPLACE="''">$authors<?/MIVAR>

	<?MIVAR NAME=$previous> <?/MIVAR>
	<?MIVAR NAME=$constraint> where <?/MIVAR>
	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$authors),$(EC,$authtype,anyauth))">
		$constraint (lower(authors) like '%$(LOWER,$authors)%')
	<?/MIVAR>
	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$authors),$(EC,$authtype,firstauth))">
		$constraint (lower(authors) like '$(LOWER,$authors)%')
	<?/MIVAR>

	<?MIVAR NAME=$previous COND="$(XST,$authors)"> and <?/MIVAR>

	<?MIVAR NAME=$constraint COND="$(XST,$title)">
		$constraint $previous (lower(title) like '%$(LOWER,$title)%')
	<?/MIVAR>

	<?MIVAR NAME=$previous COND="$(XST,$title)"> and <?/MIVAR>

	<!-- glue together the year clause if specified -->
	<?MIVAR COND="$(XST,$year)" NAME=$constraint>
		$constraint $previous year(pub_date) $yr_cmpr conc('$century','$year')
	<?/MIVAR>

	<!-- NOW  DEAL WITH THE ADDITIONAL CRITERIA -->
	<?MIVAR NAME=$previous COND="$(XST,$year)"> and <?/MIVAR>

	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$anon1text),$(EC,$anon1,abstract))">
		$constraint $previous (webhtml_like($anon1,'$anon1text'))
	<?/MIVAR>

	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$anon1text),$(NC,$anon1,abstract))">
		$constraint $previous (lower($anon1) like '%$(LOWER,$anon1text)%')	
	<?/MIVAR>

	<?MIVAR NAME=$previous COND="$(XST,$anon1text)"> and <?/MIVAR>

	<?MIVAR NAME=$constraint COND="$(NC,$jtype,any)">
		$constraint $previous (jtype='$jtype')
	<?/MIVAR>

	<?MIVAR NAME=$previous COND="$(NC,$jtype,any)"> and <?/MIVAR>

	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$pub_status),$(NC,$pub_status,any))">
		$constraint $previous (status ='$pub_status')
	<?/MIVAR>

	<?MIVAR NAME=$previous COND="$(AND,$(XST,$pub_status),$(NC,$pub_status,any))"> and <?/MIVAR>


	<?MIVAR NAME=$constraint COND="$(AND,$(XST,$cur_status),$(NC,$cur_status,any))">
		$constraint $previous (a.zdb_id=b.pub_id and b.curation_action='$cur_status')
	<?/MIVAR>

<?/MIBLOCK>


<?MIVAR NAME=$order_clause COND="$(AND,$(XST,$order_pref),$(EC,$order_pref,name))">
	order by authors,pyear desc
<?/MIVAR>
<?MIVAR NAME=$order_clause COND="$(AND,$(XST,$order_pref),$(EC,$order_pref,date))">
	order by pyear desc,authors
<?/MIVAR>

<?MIVAR NAME=$target_tables>publication<?/MIVAR>
<?MIVAR COND="$(AND,$(XST,$cur_status),$(NC,$cur_status,any))" NAME=$target_tables>publication a,curation_status b<?/MIVAR>

<!-- NOW JUST RETRIEVE AND DISPLAY ALL MATCHING ENTRIES -->
<!-- Blast all constraints if they hit "LIST ALL" -->
<?MIBLOCK COND="$(XST,$clear_all)">
	<?MIVAR NAME=$constraint> 
		where status='active' 
	<?/MIVAR>
<?/MIBLOCK>



<form method=post action="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->">

<!-- to be used by walking windows  -->
<!-- want GET string as short as possible - append only when variable exists, buffer overflow may cause segmentation fault -->
<!-- UserInput is used by walking windows to move through the data set -->
<!-- SearchInput remembers the search that was used to get here - need this infor to return to the correct search page from process-pub -->

<!-- this is all needed to support I.E., the history button and frames are not compatible so we must save variables and pass them around also history.go is not implemented the same in I.E. and Netscape  --> 

<!--- WALKING WINDOW --->
<!--- Initialization --->

<?MIVAR NAME=WINSIZE DEFAULT=25>$WINSIZE<?/MIVAR>
<?MIVAR NAME=BEGIN DEFAULT=1>$START<?/MIVAR>

<?MIVAR name=comment>  Build array of user data  <?/MIVAR>
<?MIVAR name=$selector>MIval=aa-pubselect2.apg&query_results=exists&WINSIZE=$WINSIZE<?/MIVAR>
<?MIVAR name=$UserInput><?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$authtype)>$UserInput&authtype=$authtype<?/MIVAR>	
<?MIVAR name=$UserInput COND=$(XST,$jtype)>$UserInput&jtype=$jtype<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$century)>$UserInput&century=$century<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$year)>$UserInput&year=$year<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$anon1)>$UserInput&anon1=$anon1<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$order_pref)>$UserInput&order_pref=$order_pref<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$pub_status)>$UserInput&pub_status=$pub_status<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$cur_status)>$UserInput&cur_status=$cur_status<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$return_rec)>$UserInput&return_rec=$return_rec<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$authors)>$UserInput&authors=$(URLENCODE,$authors)<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$title)>$UserInput&title=$(URLENCODE,$title)<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$yr_cmpr)>$UserInput&yr_cmpr=$(URLENCODE,$yr_cmpr)<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$anon1text)>$UserInput&anon1text=$(URLENCODE,$anon1text)<?/MIVAR>
<?MIVAR name=$UserInput COND=$(XST,$query_results)>$UserInput&query_results=$(URLENCODE,$query_results)<?/MIVAR>

</td></tr></table>  <!-- close table started in header to create a left margin, not allowing the buttons below to display properly -->

<TABLE width=100%>
	<TR>
		<TD align=center>
			<input type=submit name=printable value="Format into a printable listing">  
			<input type=submit name=refer value="Output as REFER format file">  
			<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-REFERinfo.apg">REFER&nbsp;Instructions</A>

<?MIVAR COND="$(EC,$AUTHORIZED,root)">

  <input type=button name=printable value="Add new Pub" onClick="window.location.replace('/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-edit_pub.apg&rtype=publication$UserInput');">  
<?/MIVAR>
		</TD> 
	</TR>
</TABLE>

<input type=hidden name=MIval value=aa-pubprintable.apg>
<?MIVAR COND="$(XST,$title)"> <input type=hidden name=title value="$title"><?/MIVAR>
<?MIVAR COND="$(XST,$authors)"> <input type=hidden name=authors value="$authors"><?/MIVAR>
<?MIVAR COND="$(XST,$anon1text)"> <input type=hidden name=anon1text value="$anon1text"><?/MIVAR>
<?MIVAR COND="$(XST,$anon1text)"> <input type=hidden name=anon1 value="$anon1"><?/MIVAR>
<?MIVAR COND="$(XST,$year)"> <input type=hidden name=year value="$year"><?/MIVAR>
<?MIVAR> <input type=hidden name=constraint value="$constraint"><?/MIVAR>
<?MIVAR COND="$(XST,$order_clause)"> <input type=hidden name=order_clause value="$order_clause"><?/MIVAR>

</form>

<hr width=90%>

<TABLE width=100% border=0>
  <TR>
    <TD width=20%>&nbsp;</TD>
    <TD align=center width=60%>
      <font size="+1">Publication Search Results   
      <!-- DEBUGGING <?MIVAR> CONSTRAINT=$constraint <?/MIVAR> -->
      <?MISQL SQL="select count(distinct zdb_id)::integer 
                   from $target_tables $constraint;">
      <?/MISQL> 
      <?MIVAR NAME=$num_recs>$1<?/MIVAR>
      <?MIVAR>
         (<b>$num_recs</b> records found) </b> 
      </font>
      <?/MIVAR>
    </TD>
    <TD width=20% align=center>
      <a href="#modify">Modify Search</a>
      
      <!-- Insert a form with one button. Label button Your Input Welcome -->
        <?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-input_button_generic.apg';">$1<?/MISQL>
    </TD>
  </TR>
</TABLE>

<table cellpadding=5 bgcolor=#FFFFFF width=100%><tr><td>  <!-   begin table to create left margin -->




</form>


<!-- NOW do slightly different displays, depending on whether you are selecting a value, or merely browsing. 
-->


<!--- WALKING WINDOW --->

<!--- DEFINITION OF RANGES --->
<?MIVAR NAME=BEGIN>$(IF,$(<,$BEGIN,1),1,$BEGIN)<?/MIVAR> 
<?MIVAR NAME=END>$(+,$BEGIN,$WINSIZE)<?/MIVAR>
<?MIVAR NAME=$rowNUM>$BEGIN<?/MIVAR>


<!--- EXECUTION --->
<!--- Query Database --->
<?MISQL WINSTART=$BEGIN WINSIZE=$WINSIZE
	SQL="select distinct title,authors,zdb_id,year(pub_date) as pyear, source, lower(authors) from $target_tables $constraint $order_clause;">
<TR>
<?MIVAR><TD valign=top>&nbsp;</TD><?/MIVAR>
<TD valign=top> 

$(IF,$(AND,$(NXST,$return_rec),$(EC,$ZDB_access,root)),"<FONT ><!--SIZE=-1--> <A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-edit_pub.apg&OID=$3$UserInput&START=$START">EDIT</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>")
$(IF,$(AND,$(NXST,$return_rec),$(EC,$ZDB_access,root)),"<FONT ><!--SIZE=-1--> <A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-link_authors.apg&OID=$3$UserInput&START=$START">LINK</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT>")

$(IF,$(XST,$return_rec),"<FONT ><!--SIZE=-1--><DIV class="show_pubs"> <A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-do-select.apg&return_rec=$return_rec&new_oid=$3">SELECT</A>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</FONT>")
</TD></DIV>
<TD colspan=1 align=left><font size=3><DIV class="show_pubs"> <A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-pubview2.apg&OID=$3">$2 ($4) $1. $5.</A></DIV></TD></TR>
<p>
		<?MIVAR name=$rowNUM>$(+,$rowNUM,1)<?/MIVAR>
<?/MISQL>

</Table>

<P>
<Center>
<Table width="70%" border="0" cellpadding=2>
	<tr>
		<td width="45%" align=right valign=top>&nbsp;



<!--- Return to the previous set of Rows --->
<?MIBLOCK COND="$(>,$BEGIN,1)">
	
<?MIVAR>
	<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?START=$(-,$BEGIN,$WINSIZE)&BEGIN=$BEGIN&$selector$UserInput">Prev</A>&nbsp;&nbsp;&nbsp;&nbsp;<br>

<!-- If current not First Page, create link to first page. -->
	<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?START=1&BEGIN=1&$selector$UserInput">First Page</A>
<?/MIVAR>

<?/MIBLOCK>

		</td>


<!-- Calculate 3 pages before and 3 pages after current page. -->
<?MIVAR name=$CURRENT>$(FIX,$(+,$(/,$BEGIN,$WINSIZE),1))<?/MIVAR>

<?MIBLOCK COND="$(>=,$(-,$BEGIN,$(*,$WINSIZE,3)),0)">
<td valign=top>
  <?MIVAR><A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$(-,$BEGIN,$(*,$WINSIZE,3))"> $(-,$CURRENT,3)</A> <?/MIVAR>
		</td>
<?/MIBLOCK>

<?MIBLOCK COND="$(>=,$(-,$BEGIN,$(*,$WINSIZE,2)),0)">
<td valign=top>
  <?MIVAR><A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$(-,$BEGIN,$(*,$WINSIZE,2))"> $(-,$CURRENT,2)</A><?/MIVAR>
		</td>
<?/MIBLOCK>

<?MIBLOCK COND="$(>=,$(-,$BEGIN,$(*,$WINSIZE,1)),0)">
<td valign=top>
  <?MIVAR><A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$(-,$BEGIN,$(*,$WINSIZE,1))"> $(-,$CURRENT,1)</A><?/MIVAR>
		</td>
<?/MIBLOCK>

<?MIBLOCK COND="$(>,$num_recs,$WINSIZE)">
<td align=center valign=top>
	<?MIVAR>  $CURRENT <?/MIVAR>
</td>
<?/MIBLOCK>

<?MIVAR COND=$(<=,$(+,$BEGIN,$(*,$WINSIZE,1)),$num_recs)>
<td valign=top>
<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$END"> $(+,$CURRENT,1)</A>
		</td>
<?/MIVAR>

<?MIVAR COND=$(<=,$(+,$BEGIN,$(*,$WINSIZE,2)),$num_recs)>
<td valign=top>
<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$(+,$BEGIN,$(*,$WINSIZE,2))"> $(+,$CURRENT,2)</A>
		</td>
<?/MIVAR>

<?MIVAR COND=$(<=,$(+,$BEGIN,$(*,$WINSIZE,3)),$num_recs)>
<td valign=top>
<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?$selector$UserInput&START=$(+,$BEGIN,$(*,$WINSIZE,3))"> $(+,$CURRENT,3)</A>
		</td>
<?/MIVAR>

		<td width="45%" align=left valign=top>&nbsp;

<!--- Get the next set of Rows --->
<?MIBLOCK COND="$(<=,$(+,$BEGIN,$WINSIZE),$num_recs)">
<?MIVAR>
	<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?START=$END&BEGIN=$BEGIN&$selector$UserInput">Next</A><br>
<?/MIVAR>


<!-- Calculate last page -->
<?MIVAR name=$START COND="$(=,$(MOD,$num_recs,$WINSIZE),0)">
	$(+,$(*,$(-,$(/,$num_recs,$WINSIZE),1),$WINSIZE),1)
<?/MIVAR>

<?MIVAR name=$START COND="$(!=,$(MOD,$num_recs,$WINSIZE),0)">
	$(+,$(*,$(FIX,$(/,$num_recs,$WINSIZE)),$WINSIZE),1)
<?/MIVAR>

<?MIVAR>
	<A HREF="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?START=$START&$selector$UserInput">Last Page</A>
<?/MIVAR>
<?/MIBLOCK>
		</td>
	</tr>
</Table>
</Center>

<?/MIBLOCK> <!-- xst query_results -->




<?MIBLOCK COND="$(NXST,$accession)">  <!-- don't want modify search result if come from accession search-->



    <?MIVAR COND="$(NXST,$START)" NAME=$START>1<?/MIVAR>

    <Table class=search width="100%" border=0 cellpadding=1 cellspacing=0>
      <TR>
	<td class=titlebar>
          &nbsp;&nbsp;

  <?MIBLOCK COND="$(NXST,$query_results)">
	  <b>Search for PUBLICATION</b>
  <?MIELSE>
          <a name=modify></a><b>Modify your search</b>
  <?/MIBLOCK>

        </td>
        <td class=titlebar align=right>
        <?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-input_button_generic.apg';">$1<?/MISQL>          
        </td>
      </tr>

  <form name=critform 
	method=post 
	action="/<!--|WEBDRIVER_PATH_FROM_ROOT|-->">

    <TR>
      <TD class=halfwidth>
	<b>
  <?MIVAR>
	<SELECT name=authtype onChange='document.critform.START.value = "";'>
	<option $(IF,$(EC,$authtype, anyauth),SELECTED) value=anyauth>Author contains
	<option $(IF,$(EC,$authtype,firstauth),SELECTED) value=firstauth>First Author begins with
	</select>:</b> <input type=text name=authors size=10 onChange='document.critform.START.value = "";' $(IF,$(XST,$authors),value='$authors')>
      </TD> 
  <?MIVAR>
      <TD class=halfwidth>
	<b>Year: </b> 
	<SELECT NAME=yr_cmpr onChange='document.critform.START.value = "";'>
	<option  $(IF,$(EC,$yr_cmpr,=),SELECTED) value="=">equals
	<option  $(IF,$(EC,$yr_cmpr,<),SELECTED) value="<" >before
	<option  $(IF,$(EC,$yr_cmpr,>),SELECTED) value=">" >after
	</SELECT>
	<SELECT name=century onChange='document.critform.START.value = "";'>
	<option  $(IF,$(EC,$century,19),SELECTED) value=19>19 
	<option  $(IF,$(EC,$century,20),SELECTED) value=20>20
	<option  $(IF,$(EC,$century,18),SELECTED) value=18>18 
	</SELECT>
	<input type=text name=year size=2 maxlength=2 onChange='document.critform.START.value = "";' $(IF,$(XST,$year),value='$year')>
      </TD>
  <?/MIVAR> 
    </tr>
  <?/MIVAR>

 <?MIVAR>
    <tr>
      <TD class=halfwidth>
	<b>Title contains:</b> 
	<input type=text name=title size=10 onChange='document.critform.START.value = "";' $(IF,$(XST,$title),value='$title')> 
      </TD>
      <td class=halfwidth>
 
	<b>Type:</b>
	<SELECT NAME=jtype onChange='document.critform.START.value = "";'>
	<option $(IF,$(EC,$jtype,any),SELECTED) value=any>ALL
	<option $(IF,$(EC,$jtype,Journal),SELECTED) value=Journal>Journal
	<option $(IF,$(EC,$jtype,Review),SELECTED) value=Review>Review
	<option $(IF,$(EC,$jtype,Abstract),SELECTED) value=Abstract>Abstract
	<option $(IF,$(EC,$jtype,Movie),SELECTED) value=Movie>Movie
	<option $(IF,$(EC,$jtype,Book),SELECTED) value=Book>Book
	<option $(IF,$(EC,$jtype,Chapter),SELECTED) value=Chapter>Chapter
	<option $(IF,$(EC,$jtype,Other),SELECTED) value=Other>Other
	<option $(IF,$(EC,$jtype,Unpublished),SELECTED) value=Unpublished>Unpublished
	<?MIVAR COND="$(EC,$ZDB_access,root)"><option value=Unknown>Unknown<?/MIVAR>
	</SELECT>
  <?/MIVAR>
      </TD> 
    </tr>



  <?MIVAR>
    <tr>
      <TD class=halfwidth>
	<SELECT NAME=anon1 onChange='document.critform.START.value = "";'>
	<option $(IF,$(EC,$anon1,abstract),SELECTED) value=abstract>Abstract 
	<option $(IF,$(EC,$anon1,source),SELECTED) value=source>Source
	<option $(IF,$(EC,$anon1,keywords),SELECTED) value=keywords>Keywords
	<option $(IF,$(EC,$anon1,accession_no),SELECTED) value=accession_no>Medline acc#
	<option $(IF,$(EC,$anon1,zdb_id),SELECTED) value=zdb_id>ZFIN ID
	</SELECT>
	<b>contains:</b> <input type=text name=anon1text size=10 onChange='document.critform.START.value = "";' $(IF,$(XST,$anon1text),value='$anon1text')>
      </TD>
      <TD class=halfwidth>
	<b>Order results by:</b> 
	<SELECT NAME=order_pref onChange='document.critform.START.value = "";'> 
	<option $(IF,$(EC,$order_pref,date),SELECTED) value=date>Pub Date 
	<option $(IF,$(EC,$order_pref,name),SELECTED) value=name>Author 
	</SELECT>
      </td>
    </tr>
  <?/MIVAR>


  <!-- Let root curators search based on curation status -->
  <?MIBLOCK COND="$(EC,$ZDB_access,root)">
  <?MIVAR>
    <TR>
      <TD class=halfwidth>
	<b>Curation Status:</b>
	<SELECT name=cur_status onChange='document.critform.START.value = "";'>
	<option $(IF,$(EC,$cur_status,any),SELECTED) value="any">Any
	<option $(IF,$(EC,$cur_status,Linked Authors),SELECTED) value="Linked Authors">Linked Authors
	<option $(IF,$(EC,$cur_status,Curated Genes),SELECTED) value="Curated Genes">Curated Gene Info
	<option $(IF,$(EC,$cur_status,Curated Expression data),SELECTED) value="Curated Expression data">Curated Expression Data
	<option $(IF,$(EC,$cur_status,Curated Mutant data),SELECTED) value="Curated Mutant data">Curated Mutant Data
	<option $(IF,$(EC,$cur_status,Curated Markers/Mapping),SELECTED) value="Curated Markers/Mapping">Curated Mapping/Markers
	</SELECT>  
      </TD>
      <TD class=halfwidth>
	<b>Publication Status:</b>
	<SELECT name=pub_status onChange='document.critform.START.value = "";'>
	<option $(IF,$(EC,$pub_status,any),SELECTED) value="any">Any
	<option $(IF,$(EC,$pub_status,active),SELECTED) value="active">Active
	<option $(IF,$(EC,$pub_status,inactive),SELECTED )value="inactive">Inactive
	<option $(IF,$(EC,$pub_status,temporary),SELECTED) value="temporary">Temporary
	<option $(IF,$(EC,$pub_status,uncurated),SELECTED) value="uncurated">Uncurated
	</SELECT>  
      </TD>
    </TR>
    <tr>
      <td class=fullwidth>
	<input type=button onClick="window.open('/<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-classify_pubs.apg','editor','scrollbars=yes,toolbar=no,directories=no,menubar=no,status=no,resizable=yes,width=400,height=500');" value="Classify Pubs">
      </td>
    </tr>
  <?/MIVAR>
  <?/MIBLOCK>

    <tr>
  <?MIVAR>
      <TD class=resultcount>
	Display results in groups of 
	<input type="text" name="WINSIZE" size="3" onChange='document.critform.START.value = "";' $(IF,$(XST,$WINSIZE),value='$WINSIZE',value="10")>.
	<?MIBLOCK COND="$(AND,$(NOT,$(ISNULL,$WINSIZE)),$(XST,$WINSIZE))">
	  <?MIVAR> 
	    <SCRIPT> 
	      document.critform.WINSIZE.value = "$WINSIZE" 
	    </SCRIPT>
	  <?/MIVAR> 
	<?/MIBLOCK>
      </td>
  <?/MIVAR>
    </tr>
    <tr>
      <td class=submitbar colspan=2 align="right">
	<input type=submit name=action value="SEARCH" onSubmit="document.critform.submit();"> 
	<input type=button name=action value="RESET" onClick="call_reset()"> 
	<input type=button name=clear_all value="List all publications" onClick="document.critform.reset();document.critform.submit()">
      </td>
    </tr>
  </table>



    <input type=hidden NAME="START" value=1>
    <input type=hidden NAME="query_results" value="exist">


  <!-- This next little block executes only if we are using the browser as a
  selector. That is we want user to ultimately CHOOSE a browsed value. All
  we have to do at this point is pass the return record along to the publister.
  -->
  <?MIVAR COND=$(XST,$return_rec)>
  <input type=hidden NAME="return_rec" value=$return_rec>
  <?/MIVAR>

  <input type=hidden name=MIval value=aa-pubselect2.apg>

  </form>
<?/MIBLOCK>  <!-- nxst accession -->

<?MIBLOCK COND="$(XST,$query_results)">
    </TD>
  </TR>
</TABLE>
<?MIELSE>
  <!-- Put the cursor in the AUTHORS criterion box -->
  <SCRIPT>document.critform.authors.focus();</SCRIPT>
<?/MIBLOCK>


<?MIBLOCK COND="$(NXST,$accession)">
  <?MISQL SQL="select WebExplode(object,'') from webPages where ID='aa-htmlpagefooter.apg';">$1<?/MISQL>
<?/MIBLOCK>