<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
        "http://www.springframework.org/dtd/spring-beans-2.0.dtd">

<beans>

    <!-- register them in the scheduler -->
    <bean id="scheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <!-- name used to publish applicationContext to Quartz Job instances, so they can call business services -->
        <property name="autoStartup" value="false"/>
        <property name="triggers">
            <list>
                <ref bean="regenerateWebHostDatabasesDaily"/>
                <ref bean="validateDatabasesDaily"/>
                <ref bean="pushAntibodiesToWikiWeekly"/>
                <ref bean="setPermissionsToOwnerTrigger"/>
                <ref bean="updateDOIDailyTrigger"/>
                <ref bean="updateDOIMonthlyTrigger"/>
                <ref bean="microarrayTrigger"/>
                <ref bean="sandboxCleanerTrigger"/>
                <ref bean="validateZebrafishBookPermissionsTrigger"/>
            </list>
        </property>
        <property name="quartzProperties">
            <props>
                <!-- ThreadPool -->
                <prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
                <prop key="org.quartz.threadPool.threadCount">3</prop>
                <prop key="org.quartz.threadPool.threadPriority">5</prop>
                <prop key="org.quartz.jobStore.class">org.quartz.simpl.RAMJobStore</prop>
            </props>
        </property>
    </bean>

    <!--jobs to run-->
    <bean id="regenerateWebHostDatabasesDaily" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Regenerate WebHost Curated Databases"/>
                <property name="jobClass" value="org.zfin.sequence.blast.RegenerateWebHostCuratedDatabasesJob"/>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
        <!--a nice lookup-->
        <!--fire at 2 am every day-->
        <property name="cronExpression" value="0 0 2 * * ?"/>
    </bean>


    <bean id="validateDatabasesDaily" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Validate Blast Databases"/>
                <property name="jobClass" value="org.zfin.sequence.blast.ValidateBlastDatabases"/>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
        <!--a nice lookup-->
        <!--fire at 3 am every day-->
        <property name="cronExpression" value="0 0 3 * * ?"/>
    </bean>

    <bean id="pushAntibodiesToWikiWeekly" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Synchronize ZFIN Antibodies With Wiki"/>
                <property name="jobClass" value="org.zfin.wiki.AntibodyWikiSynchronizationJob"/>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_FIRE_ONCE_NOW"/>
        <!--a nice lookup-->
        <!--fire at 3.12 am every Sunday-->
        <property name="cronExpression" value="0 12 3 ? * SUN"/>
    </bean>

    <bean id="setPermissionsToOwnerTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Set Permissions to Owner on Wiki"/>
                <property name="jobClass" value="org.zfin.wiki.SetPermissionsToOwnerJob"/>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
        <property name="cronExpression">
            <!--goes off every 15 minutes -->
            <value>0 0,15,30,45 * * * ?</value>
        </property>
    </bean>

    <bean id="validateZebrafishBookPermissionsTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Validate Zebrafish Book Permissions"/>
                <property name="jobClass" value="org.zfin.wiki.ValidatePermissionsForZebrafishBookJob"/>
            </bean>
        </property>
        <property name="cronExpression">
            <!--goes off at 2 am-->
            <value>0 0 2 * * ?</value>
        </property>
    </bean>

    <bean id="sandboxCleanerTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Clean Sandbox Wiki"/>
                <property name="jobClass" value="org.zfin.wiki.SandboxCleanerJob"/>
            </bean>
        </property>
        <property name="cronExpression">
            <!--goes off at 3 am-->
            <value>0 0 3 * * ?</value>
        </property>
    </bean>

    <bean id="updateDOIDailyTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Update DOIs Daily"/>
                <property name="jobClass" value="org.zfin.datatransfer.doi.UpdateDOIJob"/>
                <property name="jobDataAsMap">
                    <map>
                        <entry key="reportAll" value="false"/>
                    </map>
                </property>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
        <!--goes off every day at 4 am-->
        <property name="cronExpression" value="0 0 4 * * ?"/>
    </bean>


    <bean id="updateDOIMonthlyTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Update DOIs Monthly"/>
                <property name="jobClass" value="org.zfin.datatransfer.doi.UpdateDOIJob"/>
                <property name="jobDataAsMap">
                    <map>
                        <entry key="reportAll" value="true"/>
                    </map>
                </property>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_FIRE_ONCE_NOW"/>
        <!--goes off the 21st of each month-->
        <property name="cronExpression" value="0 50 03 21 * ?"/>
    </bean>


    <bean id="microarrayTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.JobDetailBean">
                <property name="name" value="Update Microarrays"/>
                <property name="jobClass" value="org.zfin.datatransfer.microarray.MicroarrayJob"/>
            </bean>
        </property>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_FIRE_ONCE_NOW"/>
        <!--goes off every Monday at 12.30 am-->
        <property name="cronExpression" value="0 30 0 ? * Mon"/>
    </bean>

</beans>
