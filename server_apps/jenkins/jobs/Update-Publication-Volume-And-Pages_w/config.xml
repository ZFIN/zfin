<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description># This script first runs a SQL to get all the active pubs at ZFIN with "Journal" and "Review" types
      which are missing vol or page numbers, and which do have
      pubmed accession (id). Then the script pulls the volume and page information from pubmed and updates
      the publication records.  The script generate 2 reports and send it to Ceri:
      one for those pubs that are updated by this script and
      the other with pubs still missing vol or page numbers could not be updated by this script</description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <scm class="hudson.scm.NullSCM"/>
  <canRoam>true</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers>
    <hudson.triggers.TimerTrigger>
      <spec></spec>
    </hudson.triggers.TimerTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <customWorkspace>$TARGETROOT</customWorkspace>
  <builders>
    <hudson.tasks.Shell>
      <command>cd $TARGETROOT/server_apps/DB_maintenance &amp;&amp; pub_check_and_addback_volpg.pl</command>
    </hudson.tasks.Shell>
  </builders>
  <publishers>
    <hudson.tasks.ArtifactArchiver>
      <artifacts>server_apps/DB_maintenance/Update-Publication-Volume-And-Pages_w/*</artifacts>
      <latestOnly>false</latestOnly>
      <allowEmptyArchive>false</allowEmptyArchive>
    </hudson.tasks.ArtifactArchiver>
    <hudson.plugins.emailext.ExtendedEmailPublisher plugin="email-ext@2.35.1">
      <recipientList></recipientList>
      <configuredTriggers>
          <hudson.plugins.emailext.plugins.trigger.SuccessTrigger>
              <email>
                  <recipientList>@SUCCESS-RECIPIENT-LIST@</recipientList>
                  <subject>$PROJECT_DEFAULT_SUBJECT</subject>
                  <body>$PROJECT_DEFAULT_CONTENT</body>
                  <sendToDevelopers>false</sendToDevelopers>
                  <sendToRequester>false</sendToRequester>
                  <includeCulprits>false</includeCulprits>
                  <sendToRecipientList>true</sendToRecipientList>
                  <attachmentsPattern>server_apps/DB_maintenance/Update-Publication-Volume-And-Pages_w/*.txt</attachmentsPattern>
                  <attachBuildLog>false</attachBuildLog>
                  <compressBuildLog>false</compressBuildLog>
                  <replyTo></replyTo>
                  <contentType>project</contentType>
              </email>
          </hudson.plugins.emailext.plugins.trigger.SuccessTrigger>
        <hudson.plugins.emailext.plugins.trigger.FailureTrigger>
          <email>
            <recipientList>@FAILURE-RECIPIENT-LIST@</recipientList>
            <subject>$PROJECT_DEFAULT_SUBJECT</subject>
            <body>$PROJECT_DEFAULT_CONTENT</body>
            <sendToDevelopers>false</sendToDevelopers>
            <sendToRequester>false</sendToRequester>
            <includeCulprits>false</includeCulprits>
            <sendToRecipientList>true</sendToRecipientList>
            <attachmentsPattern>server_apps/DB_maintenance/Update-Publication-Volume-And-Pages_w/*</attachmentsPattern>
            <attachBuildLog>false</attachBuildLog>
            <compressBuildLog>false</compressBuildLog>
            <replyTo></replyTo>
            <contentType>project</contentType>
          </email>
        </hudson.plugins.emailext.plugins.trigger.FailureTrigger>
      </configuredTriggers>
      <contentType>default</contentType>
        <defaultSubject>[Jenkins][${DOMAIN_NAME}]: ${PROJECT_NAME}: ${BUILD_STATUS}</defaultSubject>
      <defaultContent>$DEFAULT_CONTENT</defaultContent>
      <attachmentsPattern>server_apps/DB_maintenance/extentMonitoring/extentCheck.txt</attachmentsPattern>
      <presendScript>
          if(build.result == hudson.model.Result.FAILURE)
              cancel = false;
          else
              cancel = build.getArtifacts().every { artifact -&gt;
              if(artifact.getFileName().equals('updated-publications.txt') || artifact.getFileName().equals('not-updated-publications.txt'))
                artifact.getFileSize() == 0
              else
                false;
              }
      </presendScript>
      <attachBuildLog>false</attachBuildLog>
      <compressBuildLog>false</compressBuildLog>
      <replyTo>${DB_OWNER}@zfin.org</replyTo>
      <saveOutput>false</saveOutput>
    </hudson.plugins.emailext.ExtendedEmailPublisher>
  </publishers>
  <buildWrappers>
    <EnvInjectBuildWrapper plugin="envinject@1.89">
      <info>
        <propertiesFilePath>$TARGETROOT/home/WEB-INF/zfin.properties</propertiesFilePath>
        <loadFilesFromMaster>false</loadFilesFromMaster>
      </info>
    </EnvInjectBuildWrapper>
  </buildWrappers>
</project>
