# ===========================================================================
# DEVELOPMENT CRONTAB FILE
# ===========================================================================
# This is the crontab file for Informix on the ZFIN development machine.  When
# zfin.org is running on the usual production machine, this file is the crontab 
# file for the development machine.  When production is running on the 
# development machine, this file is appended to the end of the production 
# crontab file.
#
# See the "crontab" file (or cron man page) for an explanation of this file's
# format.
#
#
# cron.chart.fig
# --------------
# cron.chart.fig is a graphic depiction of cron at ZFIN.  Any time you
# change this file, also change cron.chart.fig.
#
#
#
# ========================================================================
# ====               DAILY / WEEKLY SCRIPTS                           ====
# ========================================================================
#
# -----------------------------------------------------------
# ------- 10 PM - 10:30 PM  RELOAD / INDEX            -------
# -----------------------------------------------------------
# Nights   When      Comments
# MTWT    10:00pm   Reload almdb, remake web site.
#
00 22 * * 1-4 /research/zcentral/www_homes/almost/server_apps/DB_maintenance/load_and_index_almost.pl
#
# Nights   When      Comments
# MTWTF    11:00pm   sync and checkin curated blastdbs to SVN and almost from production
00 23 * * 1-5 <!--|ROOT_PATH|-->/server_apps/DB_maintenance/backupBlastDbsAndRsyncAlmostBlastDbs.sh
#
# Nights   When      Comments
# MTWT    10:00pm   Grep errors in tests/build for nightly run on almost.
#
00 23 * * 1-4 /local/bin/ant /bin/testtest 2>&1 | /bin/grep -i fail | /bin/grep -v "Failures: 0, Errors: 0"
#
#  Sat     1:00am   Reload almdb, remake web site, generate quick search
#                    index, and copy it to production.          
00 01 * * 6 /research/zcentral/www_homes/almost/server_apps/DB_maintenance/load_and_index_almost.pl -i
#------------
#--BLAST
#------------
#  Every day at 1.30 am clean out fasta files older than one day.
30 01 * * * /usr/bin/find /research/zblastfiles/zmore/almdb -follow -type f -mtime +1 2>/research/zblastfiles/zmore/almdb/fasta-clean-error.txt | grep \.fa | xargs rm -f
33 01 * * * /usr/bin/find -follow /research/zblastfiles/zmore/test -type f -mtime +1 2>/research/zblastfiles/zmore/test/fasta-clean-error.txt | grep \.fa | xargs rm -f
#  Every day at 1.35 am clean out fasta files older than one day.
35 01 * * * /usr/bin/find /var/tmp -follow -type f -mtime +1 2>/var/tmp/fasta-clean-error.txt | grep \.fa | xargs rm -f
#  Every day at 1.40 am clean out fasta files older than seven days.
40 01 * * * /usr/bin/find /var/tmp -follow -type f -mtime +7  2>/var/tmp/blast-clean-error.txt | grep "blast.*xml"  | xargs rm -f
#
#
#
# -------------------------------------------------------------------------------------------------------
# ------  Reminders to staff
# -------------------------------------------------------------------------------------------------------
# 10 AM first day of the month report vacation and sick hours to Neuroscience contact
#
00 10 1 * * /research/zcentral/Commons/bin/email.pl
#
# M   10:10 AM  technical staff weekly status reports
10 10 * * 1 /research/zcentral/Commons/bin/status_report.pl
#
# 20th of each month reminder for curator project reports
00 10 20 * * /research/zcentral/Commons/bin/monthly_report.pl
# 
# 20th of each month reminder to restart ontape on production
00 10 20 * * /research/zcentral/Commons/bin/monthly_ontape.pl
# 
#
# several times a year in the middle of a month send email about GenBank TPA
0 0 15 4,8,12 * /research/zcentral/Commons/bin/TPA_nag.sh
#
#----------------------
#--PRODUCTION JOBS
#----------------------
# F 12:30pm
01 12 * * 6   <!--|ROOT_PATH|-->/server_apps/Reports/GO/goreport.pl
# 
# Sa 12:30am
#test run Mon at 1:05pm
30 12 * * 1 <!--|ROOT_PATH|-->/server_apps/data_transfer/Microarray/microarray.sh
#
# SMTWTFS        10:00pm   Generate standard set of download files for web site.
#
00 22 * * * <!--|ROOT_PATH|-->/server_apps/data_transfer/Downloads/DownloadFiles.pl
#
# Th       10:10pm   Generate download files for Sanger
#
10 22 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/Sanger/SangerFiles.pl
#
#
# Th        10:30pm   weekly run of GO file generation
#
30 22 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/GO/go.pl
#
#
#   Th      10:40pm   Weekly dump of data for ZIRC to pick up
#
40 22 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/ZIRC/pushToZirc.pl
#
# ------------------------------------------------------------------------
# ---- 11 PM -  1 AM : DATA TRANSFER IN                               ----
# ------------------------------------------------------------------------
#
# Nights   When      Comments
# SMTWTS    11:00pm   Get genbank daily update file, update accession_bank and db_link, the Friday run is in pull.sh
#
00 23 * * 0-4,6 <!--|ROOT_PATH|-->/server_apps/data_transfer/Genbank/gbaccession.pl
#
# SMTWT    11:10pm   load and update go terms
#
10 23 * * 0-4 <!--|ROOT_PATH|-->/server_apps/data_transfer/LoadGO/loadgo.pl
#
# SMTWT    11:20pm   load and update go terms
#
20 23 * * 0-4 <!--|ROOT_PATH|-->/server_apps/data_transfer/PATO/loadpato.pl
#
# F        10:10pm   weekly update of chromosome position and orthology for
#                    mouse, human, fly
10 22 * * 5 <!--|ROOT_PATH|-->/server_apps/data_transfer/ORTHO/loadOrthoChromInfo.pl
#
# F        11:00pm   weekly download data run, also does DATA TRANSFER OUT
#                    and BACKUPS (calls unload_production.sh at end)
00 23 * * 5 <!--|ROOT_PATH|-->/server_apps/data_transfer/pull.sh
#
#   SMTWT     1:00am   Weekly load of data from ZIRC
#
00 01 * * 0-4 <!--|ROOT_PATH|-->/server_apps/data_transfer/ZIRC/pullFromZirc.pl
#
# SMTWTFS  11:22pm   CURATOR SUPPORT: Nightly check for new publications.
#
22 23 * * * <!--|ROOT_PATH|-->/<!--|CGI_BIN_DIR_NAME|-->/publications_today.cgi
#
# 
# SMTWTF   11:33pm ReNo Support, make current Entrez Gene Nomenclature for Human & Mouse     
#
33 23 * * 0-5 <!--|ROOT_PATH|-->/server_apps/data_transfer/Load/Entrez/fetch_entrez.sh
# 
# Nights   When      Comments
# SMTWT     11:45pm   Run regen functions. Then sequentialy run scrub and validate
# SMTWT    after     Scan of char/varchar fields for bad stuff
# SMTWT    after     Validate data, daily + orphans
#
45 23 * * 0-4 cd <!--|ROOT_PATH|-->/server_apps/DB_maintenance;regen.sh;scrubscan.pl;validatedata.pl -d -o <!--|DB_NAME|--> 
# ------------------------------------------------------------------------
# ----  1 AM -  3 AM : DATA CLEANING                                  ----
# ------------------------------------------------------------------------
#
# S         3:00am   Validate data, daily + orphans + weekly
#
00 03 * * 5 <!--|ROOT_PATH|-->/server_apps/DB_maintenance/validatedata.pl -d -o -w <!--|DB_NAME|--> 
#
#
# ========================================================================
# ====                   MONTHLY SCRIPTS                              ====
# ========================================================================
#
# What exactly does night 0 mean?  Well: 
#  o The comments in this file indicate what night a cron job runs on, not 
#    what day.
#  o Nights start at 5pm and run through the following morning.
#  o The name of the night is the name of the day the night started on.
#
# Night "0" comes from applying this scheme to months.  Does the first
# night of the month start at 5 pm on the last day of the previous month,
# or does it start at 5 pm on the first day of the current month?
#
# I went with the latter: 
#  o Night 1 starts at 5 pm on the first day of the current month.
#  o Therefore, night 0 is the night that starts at 5pm on the last day of 
#    the previous month.
#
# Using night 0 should also help people notice that something different is
# going on here.  Hopefully, they will then actually put the time in to
# read these comments.
#
#
# Nights   When      Comments
# Th         2:30am   DATA CLEANING: Run monthly data validation script.
#
30 02 * * 4 <!--|ROOT_PATH|-->/server_apps/DB_maintenance/validatedata.pl -m <!--|DB_NAME|-->
#
# 0         3:15am   CURATOR SUPPORT: monthly zgc related statistics email
#
15 03 * * 4 <!--|ROOT_PATH|-->/server_apps/Reports/Count.pl
#
# 0         3:25am   CURATOR SUPPORT: monthly figure permission check
#
25 03 * * 4 <!--|ROOT_PATH|-->/server_apps/DB_maintenance/fx_permission_check.pl
#
#
# 0         3:27am   curator support: monthly pnas report for dave f.
#
27 03 * * 4 <!--|root_path|-->/server_apps/DB_maintenance/pnas_report.pl
#
# 1         3:50am   Populate DOIS with pmid only reporting thise added, monthly
#
50 03 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/DOI/monthly-doi-update.sh 
#
#  1       10:50pm   DATA TRANSFER OUT: Monthly file to Swiss-Prot
#
50 22 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/SWISS-PROT/create_file_for_swiss_prot.pl
#
#
# Nights   When      Comments
# 1         5:00am   DATA TRANSFER: run quarterly SNP load from dbSNP.
#
00 05 * * 4 <!--|ROOT_PATH|-->/server_apps/data_transfer/SNP/dbSNP.pl <!--|DB_NAME|-->
#
