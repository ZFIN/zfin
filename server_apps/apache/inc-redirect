RewriteEngine On

#zirc "order this" redirects, I'm not sure if there are CDNAs or just ESTs...
RedirectMatch /zirc-order/ZDB-EST-(.*) http://zebrafish.org/zirc/est/estAll.php?OID=ZDB-EST-$1
RedirectMatch /zirc-order/ZDB-CDNA-(.*) http://zebrafish.org/zirc/est/estAll.php?OID=ZDB-CDNA-$1
RedirectMatch /zirc-order/ZDB-GENO-(.*) http://zebrafish.org/zirc/fish/lineAll.php?OID=ZDB-GENO-$1

#rss feed redirects
Redirect  /zf_info/news/jobs.rss https://wiki.zfin.org/spaces/createrssfeed.action?types=blogpost&spaces=jobs&title=Zebrafish+Jobs&publicFeed=true&maxResults=-1&sort=created&timeSpan=120
Redirect /zf_info/news/mtgs.rss https://wiki.zfin.org/spaces/createrssfeed.action?types=blogpost&spaces=meetings&title=Zebrafish+Meetings&publicFeed=true&maxResults=-1&sort=created&timeSpan=-1
Redirect /zf_info/news/siteNews.rss https://wiki.zfin.org/spaces/createrssfeed.action?types=blogpost&spaces=news&title=Zebrafish+News&publicFeed=true&maxResults=-1&sort=created&timeSpan=120

#version independent gbrowse link
RewriteRule ^/genome-browser    /cgi-perl/gbrowse/current  [NC,PT]

#Allow use of same cgi-bin/webdriver path on all dev sites
RewriteCond <!--|MUTANT_NAME|--> !=zfin.org
RewriteRule ^/cgi-bin/webdriver(.*) /<!--|MUTANT_NAME|-->/webdriver$1 [PT]

#Do not allow https on the home page(fixes bug in logout)
RewriteCond %{HTTPS} =on
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^/$ http://%{SERVER_NAME}/ [R=301,L]

#Require https on some pages
RewriteCond %{HTTPS} =off
  # Enumerate all urls that require https here, [OR]
  # goes at the end of all but the last one
RewriteCond %{REQUEST_URI} ^/action/people/edit-user$ [OR]
RewriteCond %{REQUEST_URI} ^/action/login-redirect$
RewriteRule ^(.*)$ https://%{SERVER_NAME}/$1 [R=301,L]

#Remove extra stuff for home page url
RewriteCond <!--|MUTANT_NAME|--> !=zfin.org
RewriteRule ^/$ /<!--|MUTANT_NAME|-->/webdriver?MIval=aa-ZDB_home.apg [PT]
RewriteCond <!--|MUTANT_NAME|--> =zfin.org
RewriteRule ^/$ /cgi-bin/webdriver?MIval=aa-ZDB_home.apg [PT]

#lab designation page
RewriteRule ^/zf_info/zfbook/lab_desig.html /action/feature/line-designations [NC,R=301]

#wild-type lines
RewriteCond %{QUERY_STRING}     ^MIval=aa-wtlist.apg$    [NC]
RewriteRule ^/<!--|WEBDRIVER_PATH_FROM_ROOT|--> /action/feature/wildtype-list [NC,R=301]

# retired apg urls
RewriteCond %{QUERY_STRING}     ^Mival=aa-markerview.apg&OID=([\w-]+)$    [NC]
RewriteRule ^/<!--|WEBDRIVER_PATH_FROM_ROOT|--> /action/marker/view/%1? [NC,R=301]

RewriteCond %{QUERY_STRING}     ^Mival=aa-genotypeview.apg&OID=([\w-]+)$    [NC]
RewriteRule ^/<!--|WEBDRIVER_PATH_FROM_ROOT|--> /action/genotype/genotype-detail?zdbID=%1 [NC,R=301]

RewriteCond %{QUERY_STRING}     ^Mival=aa-anatomy_item.apg&OID=([\w-]+)$    [NC]
RewriteRule ^/<!--|WEBDRIVER_PATH_FROM_ROOT|--> /action/anatomy/anatomy-view/%1? [NC,R=301]

RewriteCond %{QUERY_STRING}     ^antibody.zdbID=([\w-]+)$    [NC]
RewriteRule ^/action/antibody/detail /action/marker/view/%1? [NC,R=301]

RewriteCond %{QUERY_STRING}     ^zdbID=([\w-]+)$    [NC]
RewriteRule ^/action/marker/transcript-view /action/marker/view/%1? [NC,R=301]

RewriteCond %{QUERY_STRING}    ^anatomyItem.zdbID=([\w-]+)$    [NC]
RewriteRule ^/action/anatomy/term-detail /action/anatomy/anatomy-view/%1? [NC,R=301]

RewriteCond %{QUERY_STRING}    ^MIval=aa-anatdict.apg
RewriteRule ^/<!--|WEBDRIVER_PATH_FROM_ROOT|--> /action/anatomy/anatomy-search? [NC,R=301]

#RewriteRule /action/anatomy/search    /action/anatomy/anatomy-search [NC,R=301]

#aliases for ZFIN_jump

RewriteCond %{QUERY_STRING}     ^record=([\w-]+)$    [NC]
RewriteRule ^/cgi-bin/ZFIN_jump /<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-jump_to.apg&record=%1 [NC,R=301]

RewriteRule ^/jump/(.*)  /<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-jump_to.apg&record=$1 [NC,PT]
RewriteRule ^/id/(.*)  /<!--|WEBDRIVER_PATH_FROM_ROOT|-->?MIval=aa-jump_to.apg&record=$1 [NC,PT]

